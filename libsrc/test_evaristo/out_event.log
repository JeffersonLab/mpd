
MPD Library Tests
----------------------------
Opening A32 Window (opened at [0xb7fbb000,0xb7fcb000])
Opening A32Blt Window (opened at [0xadfbb000,0xb7fbb000])
Opening A24 Window (opened at [0xacfbb000,0xadfbb000])
Opening A16 Window (opened at [0xacfab000,0xacfbb000])
jlabgefMapTsi: Tempe Chip Userspace map successful
VME Bus Error IRQ Disabled
vmeBusCreateLockShm: vmeBus shared memory mutex created
mpdConfigInit: cfg/config_apv.txt: Version = 0.3
Number of MPDs in config file = 1
mpdConfigLoad: Loading MPD idx=  0 rotary (slot) =  0
mpdSetTriggerMode: Calib Latency = 0, Trigger Mode = 0x2
mpdSetAcqMode: Acquisition Mode = 0x1 (event)
mpdConfigLoad: 4 APV elements in given MPD 0
mpdAddApv: APV 0 added to list of FECs
mpdAddApv: APV 1 added to list of FECs
mpdAddApv: APV 2 added to list of FECs
mpdAddApv: APV 3 added to list of FECs
mpdConfigLoad:  4 APV loaded in Slot=0 MPD settings
mpdInit: start
mpdInit: A24 mapping: VME addr=0x80000 -> Local 0xad03b000
mpdInit: Looking at MPD in slot 0
 MPD Slot 0 - Firmware Revision ID = 0x4003
 MPD Slot 0 - Firmware Revision Time: 359290 (s)
 ++ MPD in slot 0 is in config file, INIT IT
Initialized MPD  0  Slot # 0 at VME address 0x8000000 (local 0xadfbb000) 
mpdInit: Looking at MPD in slot 1
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x10001c
mpdInit: WARN: No addressable board at VME addr=0x100000 (local 0xad0bb000)
mpdInit: Looking at MPD in slot 2
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x18001c
mpdInit: WARN: No addressable board at VME addr=0x180000 (local 0xad13b000)
mpdInit: Looking at MPD in slot 3
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x20001c
mpdInit: WARN: No addressable board at VME addr=0x200000 (local 0xad1bb000)
mpdInit: Looking at MPD in slot 4
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x28001c
mpdInit: WARN: No addressable board at VME addr=0x280000 (local 0xad23b000)
mpdInit: Looking at MPD in slot 5
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x30001c
mpdInit: WARN: No addressable board at VME addr=0x300000 (local 0xad2bb000)
mpdInit: Looking at MPD in slot 6
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x38001c
mpdInit: WARN: No addressable board at VME addr=0x380000 (local 0xad33b000)
mpdInit: Looking at MPD in slot 7
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x40001c
mpdInit: WARN: No addressable board at VME addr=0x400000 (local 0xad3bb000)
mpdInit: Looking at MPD in slot 8
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x48001c
mpdInit: WARN: No addressable board at VME addr=0x480000 (local 0xad43b000)
mpdInit: Looking at MPD in slot 9
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x50001c
mpdInit: WARN: No addressable board at VME addr=0x500000 (local 0xad4bb000)
mpdInit: Looking at MPD in slot 10
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x58001c
mpdInit: WARN: No addressable board at VME addr=0x580000 (local 0xad53b000)
mpdInit: Looking at MPD in slot 11
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x60001c
mpdInit: WARN: No addressable board at VME addr=0x600000 (local 0xad5bb000)
mpdInit: Looking at MPD in slot 12
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x68001c
mpdInit: WARN: No addressable board at VME addr=0x680000 (local 0xad63b000)
mpdInit: Looking at MPD in slot 13
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x70001c
mpdInit: WARN: No addressable board at VME addr=0x700000 (local 0xad6bb000)
mpdInit: Looking at MPD in slot 14
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x78001c
mpdInit: WARN: No addressable board at VME addr=0x780000 (local 0xad73b000)
mpdInit: Looking at MPD in slot 15
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x80001c
mpdInit: WARN: No addressable board at VME addr=0x800000 (local 0xad7bb000)
mpdInit: Looking at MPD in slot 16
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x88001c
mpdInit: WARN: No addressable board at VME addr=0x880000 (local 0xad83b000)
mpdInit: Looking at MPD in slot 17
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x90001c
mpdInit: WARN: No addressable board at VME addr=0x900000 (local 0xad8bb000)
mpdInit: Looking at MPD in slot 18
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0x98001c
mpdInit: WARN: No addressable board at VME addr=0x980000 (local 0xad93b000)
mpdInit: Looking at MPD in slot 19
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0xa0001c
mpdInit: WARN: No addressable board at VME addr=0xa00000 (local 0xad9bb000)
mpdInit: Looking at MPD in slot 20
jlabgefMemProbe: Clearing VME BERR/2eST (0x800cf900) at VME address 0xa8001c
mpdInit: WARN: No addressable board at VME addr=0xa80000 (local 0xada3b000)
mpdInit: 1 MPD(s) initialized, 1 discovered
mpdInit: WARN: Unable to initialize all requested MPD Modules (1)
 MPD discovered = 1
 test mpd 0 histo memory
HISTO Read/Write test SUCCESS on MPD slot 0
 Try initialize I2C mpd in slot 0
mpdI2C_Init: i2c low prescaler register set/read : 100 / 100
mpdI2C_Init: i2c high prescaler register set/read : 4 / 4
mpdI2C_Init: i2c speed prescale = 1124, (period = 112.400000 us, frequency = 8.896797 kHz)
Board temperatures: core=128.81 air=128.81 (dec celsius)
Try APV discovery and init on MPD slot 0
mpdAPV_Scan: MPD 0 Blind scan on 31 apvs: 
mpdAPV_Try: timeout 20 : 32 ret = -20
mpdAPV_Try: timeout 20 : 33 ret = -20
mpdAPV_Try: timeout 20 : 34 ret = -20
mpdAPV_Try: timeout 20 : 35 ret = -20
mpdAPV_Try: timeout 20 : 36 ret = -20
mpdAPV_Try: timeout 20 : 37 ret = -20
mpdAPV_Try: timeout 20 : 38 ret = -20
mpdAPV_Try: timeout 20 : 39 ret = -20
mpdAPV_Try: timeout 20 : 40 ret = -20
mpdAPV_Try: timeout 20 : 41 ret = -20
mpdAPV_Try: timeout 20 : 42 ret = -20
mpdAPV_Try: timeout 20 : 43 ret = -20
mpdAPV_Try: timeout 20 : 44 ret = -20
mpdAPV_Try: timeout 20 : 45 ret = -20
mpdAPV_Try: timeout 20 : 46 ret = -20
mpdAPV_Try: timeout 20 : 47 ret = -20
mpdAPV_Try: timeout 20 : 48 ret = -20
mpdAPV_Try: timeout 20 : 49 ret = -20
mpdAPV_Try: timeout 20 : 50 ret = -20
mpdAPV_Try: timeout 20 : 51 ret = -20
mpdAPV_Try: timeout 20 : 52 ret = -20
mpdAPV_Try: timeout 20 : 53 ret = -20
mpdAPV_Try: timeout 20 : 54 ret = -20
mpdAPV_Try: timeout 20 : 55 ret = -20
mpdAPV_Try: timeout 20 : 56 ret = -20
mpdAPV_Try: timeout 20 : 57 ret = -20
mpdAPV_Try: timeout 20 : 58 ret = -20
mpdAPV_Try: timeout 20 : 59 ret = -20
mpdAPV_Try: timeout 20 : 60 ret = -20
mpdAPV_Try: timeout 20 : 61 ret = -20
mpdAPV_Try: timeout 20 : 62 ret = -20
mpdAPV_Scan: MPD 0 Blind scan done
mpdAPV_Scan: Try  1  1 : mpdAPV_Try: timeout 20 : 33 ret = -20
mpdAPV_Scan: 1 matched in MPD in slot 0
mpdAPV_Scan: APV enable mask 0x0002
mpdAPV_Scan: Try  2  2 : mpdAPV_Try: timeout 20 : 33 ret = -20
mpdAPV_Scan: 2 matched in MPD in slot 0
mpdAPV_Scan: APV enable mask 0x0006
mpdAPV_Scan: Try  3  3 : mpdAPV_Try: timeout 20 : 33 ret = -20
mpdAPV_Scan: 3 matched in MPD in slot 0
mpdAPV_Scan: APV enable mask 0x000e
mpdAPV_Scan: Try  4  4 : mpdAPV_Try: timeout 20 : 33 ret = -20
mpdAPV_Scan: 4 matched in MPD in slot 0
mpdAPV_Scan: APV enable mask 0x001e
mpdAPV_Scan: 4 APV found matching settings
Do DELAY setting on MPD slot 0
mpdDELAY25_Set: start
mpdDELAY25_Set: end
Do APV reset on MPD slot 0
Configure single APV on MPD slot 0
APV card i2c=1 to ADC (fifo)=1 (from config file)
mpdApvBufferAlloc: DEBUG: Fifo 1, buffer allocated with word size 11880
APV card i2c=2 to ADC (fifo)=2 (from config file)
mpdApvBufferAlloc: DEBUG: Fifo 2, buffer allocated with word size 11880
APV card i2c=3 to ADC (fifo)=3 (from config file)
mpdApvBufferAlloc: DEBUG: Fifo 3, buffer allocated with word size 11880
APV card i2c=4 to ADC (fifo)=4 (from config file)
mpdAPV_Config: ERROR: I2C Bus Error: i/addr/reg/val/err 0/ 4 0x2 0x0 0xffffffecERR: config apv card 3 failed in mpd 0
Configure ADC on MPD slot 0
mpdADS5281_Normal: Board= 0 ADC= 0 No Pattern (Normal Acq)
mpdADS5281_InvertChannels: Board= 0 ADC= 0 Inverted Polarity
mpdADS5281_SetGain: Board= 0 ADC= 0 Set Gain 5 5 5 5 5 5 5 5
mpdADS5281_Normal: Board= 0 ADC= 1 No Pattern (Normal Acq)
mpdADS5281_InvertChannels: Board= 0 ADC= 1 Inverted Polarity
mpdADS5281_SetGain: Board= 0 ADC= 1 Set Gain 5 5 5 5 5 5 5 5
Do 101 Reset on MPD slot 0
mpdSetAcqMode: Acquisition Mode = 0x1 (event)
mpdDAQ_Config : ReadoutConfig = 0x1
mpdTRIG_Enable: Control Addr = 0xff22001e
mpdTRIG_Enable: Trig Gen = 0x822231
mpdTRIG_Enable: Logic Threshold = 0x76c01f4
 ============ START ACQ ===========
 ---- Event 0 occurred -----
 EC: card 0 buffer size available = 11879
mpdApvGetBufferPointer: DEBUG: Fifo 1, retrieved pointer from position 0 , size is 11880
EC: nwords from fifo 1 0x38e0000
mpdFIFO_ReadSingle: number of words to be read 910
mpdFIFO_ReadSingle: DEBUG: fifo ch = 1, words in fifo= 910, retries= 1 (max 1)
mpdFIFO_ReadSingle: DEBUG: Read apv = 1, wrec = 910, success = 0
 EC: card 0 readsingle done nread=910, err=0
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: FIFO= 1, word read= 910, event/sample read= 7, error=0
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: Fifo= 0, total sample left= -1 (<0 means more samples than requested)
 EC: card 1 buffer size available = 11879
mpdApvGetBufferPointer: DEBUG: Fifo 2, retrieved pointer from position 0 , size is 11880
EC: nwords from fifo 2 0x38e038e
mpdFIFO_ReadSingle: number of words to be read 910
mpdFIFO_ReadSingle: DEBUG: fifo ch = 2, words in fifo= 910, retries= 1 (max 1)
mpdFIFO_ReadSingle: DEBUG: Read apv = 2, wrec = 910, success = 0
 EC: card 1 readsingle done nread=910, err=0
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: FIFO= 2, word read= 910, event/sample read= 7, error=0
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: Fifo= 1, total sample left= -2 (<0 means more samples than requested)
 EC: card 2 buffer size available = 11879
mpdApvGetBufferPointer: DEBUG: Fifo 3, retrieved pointer from position 0 , size is 11880
EC: nwords from fifo 3 0x38e0000
mpdFIFO_ReadSingle: number of words to be read 910
mpdFIFO_ReadSingle: DEBUG: fifo ch = 3, words in fifo= 910, retries= 1 (max 1)
mpdFIFO_ReadSingle: DEBUG: Read apv = 3, wrec = 910, success = 0
 EC: card 2 readsingle done nread=910, err=0
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: FIFO= 3, word read= 910, event/sample read= 7, error=0
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdFIFO_ReadAll: DEBUG: Fifo= 2, total sample left= -3 (<0 means more samples than requested)
mpdFIFO_ReadAll: DEBUG: Fifo= 3, total sample left= -3 (<0 means more samples than requested)
 Rdone/Tout/error = 1 0 0
0mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 1 has 7 samples (910 bytes) stored
mpdApvGetBufferPointer: DEBUG: Fifo 1, retrieved pointer from position 0 , size is 11880
mpdApvShiftDataBuffer: DEBUG: Move block of 7 words from 903 to 0
mpdApvShiftDataBuffer: DEBUG: Fifo= 1 cleaned (data shifted) write pointer at=7
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 2 has 7 samples (910 bytes) stored
mpdApvGetBufferPointer: DEBUG: Fifo 2, retrieved pointer from position 0 , size is 11880
mpdApvShiftDataBuffer: DEBUG: Move block of 7 words from 903 to 0
mpdApvShiftDataBuffer: DEBUG: Fifo= 2 cleaned (data shifted) write pointer at=7
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferSample: DEBUG: Fifo = 3 has 7 samples (910 bytes) stored
mpdApvGetBufferPointer: DEBUG: Fifo 3, retrieved pointer from position 0 , size is 11880
mpdApvShiftDataBuffer: DEBUG: Move block of 7 words from 903 to 0
mpdApvShiftDataBuffer: DEBUG: Fifo= 3 cleaned (data shifted) write pointer at=7
mpdApvGetBufferSample: DEBUG: Fifo = 4 has 0 samples (0 bytes) stored
mpdApvGetBufferPointer: DEBUG: Fifo 4, retrieved pointer from position 0 , size is 0
